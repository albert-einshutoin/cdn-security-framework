{
  "resource": {
    "aws_wafv2_rule_group": {
      "example-cdn-security-rate-limit": {
        "name": "example-cdn-security-rate-limit",
        "scope": "REGIONAL",
        "capacity": 2,
        "rule": [
          {
            "name": "rate-based-rule",
            "priority": 1,
            "action": {
              "block": {}
            },
            "statement": {
              "rate_based_statement": {
                "limit": 2000,
                "aggregate_key_type": "IP"
              }
            },
            "visibility_config": {
              "cloudwatch_metrics_enabled": true,
              "metric_name": "example-cdn-security-rate-limit",
              "sampled_requests_enabled": true
            }
          }
        ],
        "visibility_config": {
          "cloudwatch_metrics_enabled": true,
          "metric_name": "example-cdn-security-rule-group",
          "sampled_requests_enabled": true
        }
      }
    }
  }
}